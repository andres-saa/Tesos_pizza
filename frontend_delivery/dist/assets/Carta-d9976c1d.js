import{_ as q,b as s,j as z,r as k,o as u,c as p,a as i,e as l,w as D,F as B,k as M,q as E,g as G,n as H,s as C,i as W,U as J,t as K,v as Q,x as X}from"./index-8c84e25c.js";import{B as Y}from"./Banner-3a3211f2.js";import{p as Z}from"./ProductService-0ac95a0d.js";import"./fetchService-57b57f4c.js";import"./reportes-b03db83c.js";const U=v=>(Q("data-v-61d1fd9a"),v=v(),X(),v),ee={style:{padding:"3rem"}},ae=U(()=>l("h2",null,[l("b",null,"Arrastra y Reordena las Imágenes")],-1)),te={class:"image",style:{display:"flex","flex-direction":"column",position:"relative","justify-content":"end","align-items":"end"}},oe=["src"],le={key:1,style:{position:"absolute",left:"0",top:"0",width:"100%",display:"flex","justify-content":"center","align-items":"center",height:"100%","background-color":"#ffffff80"}},ne={class:"col-12 px-0 pb-0"},se={class:"draggable-container"},ie=["onDragstart","onDragenter","onDrop","data-index"],re=["src","alt"],ce={class:"confirmation-content"},de=U(()=>l("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"2rem",color:"#ff9800"}},null,-1)),ue={class:"message"},pe={class:"dialog-footer"},ve={__name:"Carta",setup(v){const n=s([]),w=z(()=>n.value.slice().sort((e,a)=>e.index-a.index)),f=s(-1),g=s(-1),m=s(!1),d=s(null),_=s(!1),x=s(!1),c=s([]),h=s(null),S=s(null);function F(e){f.value=e}function P(e){g.value=e}function $(){g.value=-1}function j(e){if(e===f.value)return;const a=w.value[f.value],t=n.value.findIndex(r=>r.id===a.id);n.value.splice(t,1),n.value.splice(e,0,a),n.value.forEach((r,y)=>{r.index=y}),f.value=-1,g.value=-1}function R(e){d.value=e,m.value=!0}function A(){m.value=!1,d.value=null}function L(){if(d.value){const e=n.value.findIndex(a=>a.id===d.value.id);e!==-1&&(n.value.splice(e,1),n.value.forEach((a,t)=>{a.index=t}))}A()}function N(){_.value=!0}function O(){S.value.click()}function V(e){const a=e.target.files;a.length!==0&&(c.value=Array.from(a),c.value.length>0&&(h.value=URL.createObjectURL(c.value[0])),e.target.value="")}async function T(){if(c.value.length===0){alert("Por favor selecciona al menos una imagen.");return}x.value=!0;try{for(const e of c.value){const a=new FormData;a.append("file",e);const t=await Z.uploadPhoto(a),r={id:Date.now()+Math.random(),src:t.image_identifier,title:e.name,index:n.value.length};n.value.push(r)}c.value=[],h.value=null,_.value=!1}catch(e){console.error("Error al subir las imágenes:",e),alert("Hubo un error al subir las imágenes.")}finally{x.value=!1}}return(e,a)=>{const t=k("Button"),r=k("ProgressSpinner"),y=k("Dialog");return u(),p(B,null,[i(Y),l("div",ee,[ae,i(t,{style:{margin:"1rem 0","background-color":"var(--primary-color)",border:"none"},label:"Agregar Imágenes",icon:"pi pi-upload",onClick:N}),i(y,{header:"Agregar Imágenes",visible:_.value,"onUpdate:visible":a[0]||(a[0]=o=>_.value=o),modal:"",style:{width:"40rem"}},{footer:D(()=>[l("div",ne,[i(t,{onClick:T,severity:"success",label:"Guardar"})])]),default:D(()=>[l("div",te,[h.value?(u(),p("img",{key:0,src:h.value,alt:"Preview",style:{width:"100%","aspect-ratio":"19 / 9","background-color":"rgb(255, 255, 255)","object-fit":"cover","border-radius":"0.2rem"}},null,8,oe)):E("",!0),x.value?(u(),p("div",le,[i(r,{strokeWidth:"8",style:{color:"white"}})])):E("",!0),i(t,{class:"my-3",severity:"help",onClick:O},{default:D(()=>[G("Agregar foto")]),_:1}),l("input",{type:"file",ref_key:"fileInput",ref:S,onChange:V,style:{display:"none"},multiple:"",accept:"image/*"},null,544)])]),_:1},8,["visible"]),l("div",se,[(u(!0),p(B,null,M(w.value,(o,b)=>(u(),p("div",{style:{position:"relative"},key:o.id,class:H(["draggable-item",{"drag-over":g.value===b}]),draggable:"true",onDragstart:I=>F(b),onDragenter:C(I=>P(b),["prevent"]),onDragover:a[1]||(a[1]=C(()=>{},["prevent"])),onDragleave:$,onDrop:I=>j(b),"data-index":o.index},[l("img",{src:`${W(J)}/read-photo-product/${o.src}`,alt:o.title},null,8,re),i(t,{style:{"border-radius":"50%",position:"absolute","background-color":"var(--primary-color)",border:"3px solid","aspect-ratio":"1 / 1",right:"-1.5rem",top:"-1.5rem"},icon:"pi pi-times",severity:"info",class:"delete-button",onClick:C(I=>R(o),["stop"])},null,8,["onClick"])],42,ie))),128)),i(y,{header:"Confirmar Eliminación",visible:m.value,"onUpdate:visible":a[2]||(a[2]=o=>m.value=o),modal:"",closable:!1,style:{width:"350px"}},{default:D(()=>{var o;return[l("div",ce,[de,l("span",ue,'¿Estás seguro de que deseas eliminar "'+K((o=d.value)==null?void 0:o.title)+'"?',1)]),l("div",pe,[i(t,{label:"Sí, eliminar",icon:"pi pi-check",class:"p-button-danger",onClick:L}),i(t,{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:A})])]}),_:1},8,["visible"])])])],64)}}},ye=q(ve,[["__scopeId","data-v-61d1fd9a"]]);export{ye as default};
