import{r as E}from"./resumen-CpbgvIni.js";import{g,p as F,q as N,k as S,B as q,m as z,o as c,c as u,b as r,w as P,a as t,f as i,s as _,F as f,h as x,t as h,C as U,y as A,x as k,z as T,n as G,D as L,_ as D,E as I}from"./index-Bttz-1xV.js";const H={style:{color:"black"},class:"grid"},M={class:"mb-2"},O={class:"mb-2 text-center"},J={class:"mt-2"},K={key:0,class:"p-0",style:{display:"flex",width:"100%",gap:"1rem"}},Q={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},R={class:"text-sm adicion",style:{"text-transform":"capitalize"}},W={key:0,style:{display:"flex","align-items":"center"}},X={key:0,class:"pl-2 py-1 text-sm"},Y={key:1,class:"pl-2 py-1 text-sm"},Z={class:"col-12 p-0",style:{display:"flex","justify-content":"center","font-weight":"bold"}},ee={__name:"dialogAddAditions",setup(B){const n=g({}),C=F(),y=N(),b=(s,a)=>{if(s.checked){const d={id:s.aditional_item_instance_id,name:s.aditional_item_name,price:s.aditional_item_price,group:a};n.value[d.id]={...d,quantity:s.quantity||1}}else delete n.value[s.aditional_item_instance_id]},$=s=>{if(s.checked){const a={id:s.aditional_item_instance_id,name:s.aditional_item_name,price:s.aditional_item_price};n.value[a.id].quantity++}},w=s=>{n.value[s.aditional_item_instance_id].quantity>1&&n.value[s.aditional_item_instance_id]&&n.value[s.aditional_item_instance_id].quantity--};S(()=>y.visibles.addAdditionToCart,async s=>{if(!s)n.value={},v.value=[];else{const a=y.cart.products.map(d=>d.product.id);a.length>0&&(v.value=await q.getAditionalGroup(a,5))}},{deep:!0});const V=()=>{Object.values(n.value).forEach(a=>{y.addAdditionToCart(a),console.log(a)}),n.value={},y.setVisible("addAdditionToCart",!1)},v=g([]);return g(!0),z(async()=>{var a,d;const s=y.cart.products.map(e=>e.product.id);s.length>0&&(v.value=await q.getAditionalGroup(s,(d=(a=C.location)==null?void 0:a.site)==null?void 0:d.site_id))}),(s,a)=>(c(),u("div",null,[r(i(L),{class:"mx-3",closable:!0,style:G([{"background-color":"white"},{width:"30rem","border-radius":"0.5rem"}]),visible:i(y).visibles.addAdditionToCart,"onUpdate:visible":a[1]||(a[1]=d=>i(y).visibles.addAdditionToCart=d),modal:"",header:"Header"},{footer:P(()=>[t("div",Z,[r(i(_),{onClick:V,style:{width:"auto"},severity:"danger",label:"Agregar al carrito"})])]),default:P(()=>[t("div",H,[(c(!0),u(f,null,x(v.value,d=>(c(),u("div",{class:"col-12",style:{},key:d.category},[t("div",M,[t("span",O,[t("b",null,h(d.category),1)]),t("div",J,[(c(!0),u(f,null,x(d.items,e=>{var l,o;return c(),u("div",{key:e.aditional_item_instance_id,style:{display:"flex",gap:"1rem"}},[i(y).cart.products.some(p=>p.product.category_name==e.product_category_name)?(c(),u("div",K,[r(i(U),{class:"my-1",binary:!0,modelValue:e.checked,"onUpdate:modelValue":p=>e.checked=p,onChange:()=>b(e,d.category)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t("div",Q,[t("span",R,h(e.aditional_item_name),1),e.checked&&d.category!="SALSAS"?(c(),u("span",W,[e.aditional_item_price>0?(c(),u("span",X,[t("b",null,h(i(A)(e.aditional_item_price*((l=n.value[e.aditional_item_instance_id])==null?void 0:l.quantity))),1)])):k("",!0),r(i(_),{onClick:p=>w(e),class:"ml-2",severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-minus"},null,8,["onClick"]),r(i(T),{modelValue:(o=n.value[e.aditional_item_instance_id])==null?void 0:o.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),r(i(_),{onClick:p=>$(e),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-plus"},null,8,["onClick"])])):e.aditional_item_price>0?(c(),u("span",Y,[t("b",null,h(i(A)(e.aditional_item_price)),1)])):k("",!0)])])):k("",!0)])}),128)),a[2]||(a[2]=t("hr",null,null,-1))])])]))),128))]),r(i(_),{onClick:a[0]||(a[0]=d=>i(y).setVisible("addAdditionToCart",!1)),icon:"pi pi-times",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",severity:"danger"})]),_:1},8,["visible"])]))}},te={class:"col-12 my-8 md:my-8 p-0"},ie={class:"mx-auto container",style:{"max-width":"900px"}},se={class:"",style:{display:"flex","flex-direction":"column",position:"sticky",top:"8rem",gap:"1rem","justify-content":"center"}},ne={class:"p-3 p-shadow",style:{display:"flex","align-items":"end",position:"relative",gap:"1rem","border-radius":"0.3rem"}},oe=["src"],ae={style:{display:"flex","flex-direction":"column",gap:"0.4rem",width:"100%"}},le={style:{display:"flex","flex-direction":"column",gap:"0.3rem",width:"100%"}},re={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%",gap:"1rem"}},de={class:"p-0 m-0"},ce={style:{"text-transform":"uppercase","font-weight":"bold"}},ue={style:{display:"flex"}},pe={class:"p-0",style:{"box-shadow":"0 0 0.5rem rgba(0, 0, 0, 0.2)","background-color":"#ff620000","border-radius":"5rem",display:"flex"}},me={class:"p-0 m-0"},_e={class:"p-0 mt-1"},ye={class:"mb-2"},he={class:"mb-2 text-center"},ve={class:"mt-2"},ge={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},be={class:"text adicion",style:{"text-transform":"capitalize"}},fe={style:{display:"flex","align-items":"center"}},xe={key:0,class:"pl-2 py-1 text-sm"},ke={key:1,style:{"box-shadow":"0 0 5px rgba(0, 0, 0, 0.411)",display:"flex","border-radius":"0.3rem"},class:"ml-2"},Ce={__name:"cart",setup(B){const n=N(),C=F(),y=g({}),b=g({}),$=I(),w=()=>{b.value=n.cart.additions.reduce((e,l)=>{let o=l.group;return e[o]||(e[o]=[]),e[o].push(l),e},{})};S(()=>n.cart.additions,()=>{w()},{deep:!0});const V=e=>{const l={...e};l.quantity=1,n.addAdditionToCart(l)},v=e=>{e.quantity>1&&n.removeAdditionFromCart(e.id)},s=e=>{n.removeAdditionCompletelyFromCart(e.id),w()},a=e=>{e.forEach(l=>{s(l)})};S(()=>n.visibles.addAdditionToCart,e=>{e&&(y.value={})},{deep:!0});const d=g([]);return z(async()=>{var l;((l=$.user.payment_method_option)==null?void 0:l.id)!=7?C.setNeighborhoodPrice():C.setNeighborhoodPriceCero();const e=53;d.value=await q.getAditional(e),b.value=n.cart.additions.reduce((o,p)=>{let m=p.group;return o[m]||(o[m]=[]),o[m].push(p),o},{})}),(e,l)=>(c(),u("div",null,[t("div",te,[l[2]||(l[2]=t("h4",{class:"title",style:{}},"Carrito de compras",-1)),t("div",ie,[t("div",se,[(c(!0),u(f,null,x(i(n).cart.products,o=>(c(),u("div",ne,[t("img",{style:{width:"5rem","object-fit":"cover",height:"5rem"},src:`https://backend.salchimonster.com/read-photo-product/${o.product.img_identifier}/600`,alt:""},null,8,oe),r(i(_),{class:"ml-2",onClick:p=>i(n).removeProductFromCart(o.product.id),icon:"pi pi-times",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),t("div",ae,[t("div",le,[t("div",re,[t("span",de,h(o.product.product_name),1)]),t("span",ce,h(o.product.category_name),1),t("div",ue,[l[1]||(l[1]=t("div",null,null,-1)),t("div",pe,[r(i(_),{onClick:p=>i(n).removeProductInstance(o.product.id),icon:"pi pi-minus",severity:"sucess",style:{border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0.4rem 0 0 0.4rem"}},null,8,["onClick"]),r(i(T),{class:"text-center",style:{"background-color":"transparent","font-weight":"bold",width:"3rem",height:"1.5rem",color:"black",border:"none"},modelValue:o.quantity,readonly:""},null,8,["modelValue"]),r(i(_),{onClick:p=>i(n).addProductToCart(o.product),icon:"pi pi-plus ",severity:"sucess",style:{"font-weight":"bold",border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0 0.4rem   0.4rem 0"}},null,8,["onClick"])])])])]),t("h5",me,[t("b",null,h(i(A)(o.total_cost)),1)])]))),256)),t("div",_e,[(c(!0),u(f,null,x(b.value,(o,p)=>(c(),u("div",{class:"p-shadow p-3 mb-4",key:p,style:{position:"relative","border-radius":"0.3rem"}},[r(i(_),{class:"ml-2",onClick:m=>a(o),icon:"pi pi-times",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),t("div",ye,[t("span",he,[t("b",null,h(p),1)]),t("div",ve,[(c(!0),u(f,null,x(o,m=>(c(),u("div",{key:m.aditional_item_instance_id,style:{display:"flex",gap:"1rem","align-items":"center"}},[r(i(_),{text:"",rounded:"",onClick:j=>s(m),class:"p-0 m-0",severity:"danger",style:{width:"2rem",height:"2rem",border:"none"},icon:"pi pi-times m-0"},null,8,["onClick"]),t("div",ge,[t("span",be,h(m.name),1),t("span",fe,[m.price>0?(c(),u("span",xe,[t("b",null,h(i(A)(m.price*m.quantity)),1)])):k("",!0),p!="SALSAS"?(c(),u("div",ke,[r(i(_),{onClick:j=>v(m),severity:"sucess",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0.3rem 0 0 0.3rem"},icon:"pi pi-minus"},null,8,["onClick"]),r(i(T),{modelValue:m.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),r(i(_),{onClick:j=>V(m),severity:"sucess",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0 0.3rem 0.3rem 0"},icon:"pi pi-plus"},null,8,["onClick"])])):k("",!0)])])]))),128))])])]))),128)),t("div",{onClick:l[0]||(l[0]=o=>i(n).setVisible("addAdditionToCart",!0)),class:"col-12 p-0 m-0",style:{display:"flex","justify-content":"end"}},[r(i(_),{style:{width:"2rem",left:".3rem",height:"2rem"},rounded:"",severity:"danger",icon:"pi pi-plus"})])])]),r(E,{class:"md:col-6"})])]),r(ee)]))}},$e=D(Ce,[["__scopeId","data-v-c1ca0095"]]);export{$e as default};
